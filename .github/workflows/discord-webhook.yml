name: Test Discord Webhook

on:
  workflow_dispatch:  # S√≥ executa manualmente

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Test Discord Webhook
      run: |
        if [ -z "${{ secrets.DISCORD_WEBHOOK_URL }}" ]; then
          echo "‚ùå DISCORD_WEBHOOK_URL n√£o configurado!"
          exit 1
        fi
        
        # Enviar mensagem de teste
        curl -H "Content-Type: application/json" \
        -X POST \
        -d '{
          "embeds": [{
            "title": "üß™ Teste de Conex√£o",
            "description": "Webhook do Discord configurado com sucesso!",
            "color": 65280,
            "fields": [{
              "name": "Reposit√≥rio",
              "value": "${{ github.repository }}",
              "inline": true
            }],
            "timestamp": "'$(date -u +%Y-%m-%dT%H:%M:%S.000Z)'"
          }]
        }' \
        "${{ secrets.DISCORD_WEBHOOK_URL }}"
        
        echo "‚úÖ Mensagem de teste enviada!"
